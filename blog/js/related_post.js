function isTagRelated(t,e){var r=!1;return e.forEach(function(e){t==e.name&&(r=!0)}),r}function findItem(t,e,r){for(var a=0;a<t.length;a++)if(t[a][e]==r)return a;return-1}function compare(t){return function(e,r){var a=e[t];return r[t]-a}}hexo.extend.helper.register("related_posts",function(t,e){var r=[];if(t.tags.forEach(function(a){e.forEach(function(e){if(isTagRelated(a.name,e.tags)){var n={title:e.title,path:e.path,weight:1},i=findItem(r,"path",e.path);-1!=i?r[i].weight+=1:t.path!=e.path&&r.push(n)}})}),0==r.length)return"";var a='<h3>相关文章：</h3><ul class="related-posts">';r=r.sort(compare("weight"));for(var n=0;n<Math.min(r.length,10);n++)a+='<li><a href="/'+r[n].path+'">'+r[n].title+"</a></li>";return a+="</ul>"});